<!-- "Cyber-Grid" Comparison Grid -->
<div class="col-span-1 lg:col-span-3 grid grid-cols-1 md:grid-cols-2 gap-8 w-full mt-4">

    {% for item in results %}
    <!-- Floating Card -->
    <div
        class="glass-panel float-card rounded-3xl p-0 flex flex-col h-full transform transition-all duration-300 hover:border-electricCyan group relative">

        <!-- Image Section -->
        <div class="h-64 w-full p-8 bg-black/20 flex items-center justify-center relative overflow-hidden">
            <!-- Security Badge -->
            <div
                class="absolute top-4 left-4 z-10 flex items-center gap-2 bg-black/60 rounded-full px-3 py-1 border border-green-500/30">
                <div class="w-2 h-2 rounded-full bg-green-400 security-pulse"></div>
                <span class="text-[10px] text-green-400 font-bold tracking-wider uppercase">SSL Verified</span>
            </div>

            <img src="{{ item.image|default:'https://via.placeholder.com/300' }}" alt="{{ item.name }}"
                class="max-h-full max-w-full object-contain filter drop-shadow-[0_10px_20px_rgba(255,255,255,0.1)] transition-transform duration-500 group-hover:scale-110">
        </div>

        <!-- Content Section -->
        <div class="p-6 flex flex-col flex-grow relative">
            <!-- Store Badge -->
            <div
                class="absolute -top-4 right-6 bg-gradient-to-r {% if item.store == 'Amazon' %}from-yellow-600 to-yellow-400{% else %}from-blue-600 to-blue-400{% endif %} px-4 py-1 rounded-full text-xs font-bold shadow-lg">
                {{ item.store }}
            </div>

            <h3 class="text-xl font-[500] text-gray-100 mb-2 leading-tight line-clamp-2">{{ item.name }}</h3>

            <div class="flex items-end gap-3 mb-6 mt-auto">
                <span
                    class="text-3xl font-[800] text-transparent bg-clip-text bg-gradient-to-r from-white to-gray-400">₹{{
                    item.price }}</span>
                {% if item.original_price %}
                <span class="text-sm text-gray-500 line-through mb-1">₹{{ item.original_price }}</span>
                {% endif %}
            </div>

            <!-- Actions -->
            <div class="grid grid-cols-2 gap-4">
                <a href="{{ item.url }}" target="_blank"
                    class="magnetic-btn relative overflow-hidden rounded-xl bg-electricCyan/10 border border-electricCyan/30 text-electricCyan py-3 font-bold text-center hover:bg-electricCyan hover:text-black transition-all duration-300">
                    BUY NOW
                </a>

                <!-- Interactive Watchlist Toggle -->
                <button
                    class="magnetic-btn rounded-xl bg-gray-800/50 border border-gray-700 text-gray-300 py-3 font-bold hover:bg-neonPurple hover:border-neonPurple hover:text-white transition-all duration-300"
                    hx-post="{% url 'scraper:toggle_watchlist' %}" hx-vars='{"product_id": "{{ item.id }}"}'
                    hx-swap="outerHTML">
                    <i class="far fa-heart mr-2"></i> WATCH
                </button>
            </div>
        </div>
    </div>
    {% empty %}
    <div class="col-span-1 lg:col-span-3 text-center py-12 glass-panel rounded-3xl">
        <h3 class="text-2xl font-[300] text-gray-400 mb-2">Target Acquisition Failed</h3>
        <p class="text-gray-600">No assets found matching criteria. Adjust sensors and retry.</p>
    </div>
    {% endfor %}

</div>

<!-- GSAP Stagger for Results -->
<script>
    if (typeof gsap !== 'undefined') {
        gsap.from(".float-card", {
            duration: 0.8,
            y: 100,
            opacity: 0,
            stagger: 0.2,
            ease: "back.out(1.7)"
        });
    }
</script>